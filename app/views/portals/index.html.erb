<div class="page-header">
  <h1>Listing Guardian Portals</h1>
</div>

<% if notice %>
  <div class="alert alert-success">
    <button type="button" class="close" data-dismiss="alert">&times;</button>
    <%= notice %>
  </div>
<% end %>

<%= will_paginate @records %>

<table class="table table-striped table-bordered">
  <thead><tr>
    <th>Agent ID</th>
    <th>Portal Name</th>
    <th>Captured</th>
    <th>Age</th>
    <th>Address & Coordinate</th>
    <th>Note</th>
    <th>Status</th>
    <th>Action</th>
  </tr></thead>

<tbody><% @portals.each do |portal| %>
  <tr>
    <td><%= portal.agent_name %></td>
    <td><%= link_to portal.portal_name, portal.link, target: "_blank" %></td>
    <td><%= portal.captured_date %></td>
    <td><%= ((@now - portal.captured_date) / 86400).round %> days</td>
    <td><%= link_to portal.location, 'https://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q=' + portal.location.gsub(' ', '+') + '&aq=&sll=37.0625,-95.677068&sspn=42.310334,73.388672&vpsrc=0&ie=UTF8&hq=&hnear=' + portal.location.gsub(' ', '+') + '&t=m&z=17&iwloc=A', target: "_blank" %><br /><%= link_to portal.lat_coordinate.to_s + ', ' + portal.lng_coordinate.to_s , 'https://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q=' + portal.lat_coordinate.to_s + ',+' + portal.lng_coordinate.to_s + '&aq=&sll=37.09024,-85.166016&sspn=42.310334,73.388672&vpsrc=0&ie=UTF8&t=m&z=17&iwloc=A', target: "_blank" %></td>
    <td><%= portal.note %></td>
    <td><%= portal.status_string %><%= ' by ' + portal.destroyed_by + ' on ' + portal.destruction_date.in_time_zone('Kuala Lumpur').to_s if portal.status_string == 'Destroyed' %></td>
    <td><%= link_to 'Edit', edit_portal_path(portal, :page => params[:page]), :class => 'btn btn-mini' %></td>
  </tr>
<% end %></tbody>
</table>

<%= will_paginate @records %>

<div class="form-actions">
  <%= link_to 'New Portal', new_portal_path, :class => 'btn btn-primary' %>
</div>
